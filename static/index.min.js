"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var palette=document.getElementById("palette"),preview=document.getElementById("preview"),drop_input=document.getElementById("drop_input"),imgupload=document.getElementById("imgupload"),number=document.getElementById("number"),colorlist=document.getElementById("hexcolors"),copycolors=document.getElementById("copycolors"),viewtype=document.getElementsByName("viewtype"),reset=document.getElementById("reset"),preventDefaults=function(e){e.preventDefault(),e.stopPropagation()},currentFile=null,clicked=!1;function changeView(e){if("regular"==(palette.className=e)){document.getElementsByClassName("card");clicked&&(reset.classList.add("show"),reset.classList.remove("hide"))}else reset.classList.remove("show"),reset.classList.add("hide")}function imgData(e){e!==currentFile&&(currentFile=e);var r=e[0];r&&(128<number.value||number.value<1||("image/jpeg"===r.type||"image/png"===r.type||"image/gif"===r.type||"image/webp"===r.type?new Promise(function(e,t){var n=new FileReader;n.onloadend=function(){drop_input.style.backgroundImage="url('".concat(n.result,"')"),e(n.result.split(",")[1])},n.readAsDataURL(r)}).then(function(e){palette.innerHTML='<div><div id="spinner-parent"><img src="spinner.png" id="spinner" /></div><p>Fetching swatches...</p></div>',fetch("/imagedata",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({number:number.valueAsNumber,imgfile:e})}).then(function(e){return e.json()}).then(function(o){palette.innerHTML="",colorlist.innerText="[".concat(o.hex.join(", "),"]");var s=[];console.log(o),o.hex.map(function(e,t){var n=document.getElementById("card_template").cloneNode(!0);n.removeAttribute("id");var r=n.getElementsByClassName("swatch")[0];r.style.backgroundColor=e,r.title=e,n.getElementsByClassName("colorhex")[0].textContent=e;var a=n.getElementsByClassName("colorlist")[0];a.style.borderColor=e,a.getElementsByClassName("hex")[0].innerText="Hex: ".concat(e),a.getElementsByClassName("rgb")[0].innerText="RGB: ".concat(o.rgb[t].join(", ")),a.getElementsByClassName("hsl")[0].innerText="HSL: ".concat(hls(o.hls[t]).join(", ")),a.getElementsByClassName("hsv")[0].innerText="HSV: ".concat(hsv(o.hsv[t]).join(", ")),n.classList.add("animate-in"),n.addEventListener("click",function(){palette.classList.contains("compact")||n.classList.contains("flip-vertical-right")||(n.classList.add("flip-vertical-right"),clicked||(reset.classList.add("show"),reset.classList.remove("hide"),clicked=!0))},!1),s.push(n);var i=document.createElement("div");i.id="spacer_"+t,i.className="spacer",palette.appendChild(i)});var e=0,t=setInterval(function(){e==number.valueAsNumber-1&&clearInterval(t),document.getElementById("spacer_"+e).appendChild(s[e]),e++},100)}).catch(function(){palette.innerHTML="File error. Try another image."})}):palette.innerHTML="Unsupported file type."))}function hls(e){var t=_toConsumableArray(e),n=t[0],r=t[1];return[100*n+.5|0,(100*t[2]+.5|0)+"%",(100*r+.5|0)+"%"]}function hsv(e){var t=_toConsumableArray(e);return[100*t[0]+.5|0,(100*t[1]+.5|0)+"%",(100*t[2]+.5|0)+"%"]}window.onload=function(){return imgupload.value=null},viewtype[0].checked?palette.className="regular":palette.className="compact",["dragenter","dragover","dragleave","drop"].forEach(function(e){drop_input.addEventListener(e,preventDefaults,!1)}),["dragenter","dragover"].forEach(function(e){drop_input.addEventListener(e,function(){drop_input.classList.add("highlight")},!1)}),["dragleave","drop"].forEach(function(e){drop_input.addEventListener(e,function(){drop_input.classList.remove("highlight")},!1)}),drop_input.addEventListener("drop",function(e){imgData(e.dataTransfer.files)},!1),drop_input.addEventListener("click",function(e){imgupload.click()},!1),number.onchange=function(){imgData(currentFile)},copycolors.addEventListener("click",function(e){hexcolors.select(),document.execCommand("copy")}),reset.addEventListener("click",function(e){for(var t=document.getElementsByClassName("card"),n=0;n<t.length;n++)t[n].classList.remove("flip-vertical-right");reset.classList.remove("show"),reset.classList.add("hide"),clicked=!1});
